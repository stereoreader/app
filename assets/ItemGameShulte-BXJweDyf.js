import{d as g,s as l,g as a}from"./index-BupBFJ1M.js";class d{constructor(t){this.item=t}containers=[];numbers=[];resizeObserver=null;off=[];get fontSize(){return l.fontSize}get textColor(){return a.textColor}get size(){return this.item.settings.size}start(t){if(t.length===0)throw new Error("At least one container is required");this.stop(),this.containers=t,this.observeResize(),this.next()}next(){this.generateNumbers(),this.render()}stop(){this.resizeObserver?.disconnect(),this.resizeObserver=null;for(const t of this.containers)t.innerHTML="";this.containers=[],this.numbers=[],this.off.forEach(t=>t())}generateNumbers(){const t=this.size*this.size;this.numbers=Array.from({length:t},(s,i)=>i+1);for(let s=t-1;s>0;s-=1){const i=Math.floor(Math.random()*(s+1)),n=this.numbers[s];this.numbers[s]=this.numbers[i],this.numbers[i]=n}}render(){const s=this.containers[0].getBoundingClientRect(),i=s.width/this.size,n=s.height/this.size;for(const h of this.containers){h.innerHTML="";for(let r=0;r<this.numbers.length;r+=1){const m=Math.floor(r/this.size),u=r%this.size,e=document.createElement("div");e.textContent=String(this.numbers[r]),e.style.position="absolute",e.style.left=`${u*i}px`,e.style.top=`${m*n}px`,e.style.width=`${i}px`,e.style.height=`${n}px`,e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.boxSizing="border-box";const o=`1px solid color-mix(in srgb, ${this.textColor} 50%, transparent)`;r%this.size||(e.style.borderLeft=o),r<this.size&&(e.style.borderTop=o),e.style.borderRight=e.style.borderBottom=o,e.style.color=this.textColor,e.style.fontSize=`${this.fontSize}px`,e.style.lineHeight=`${this.fontSize}px`,e.style.overflow="hidden",e.style.whiteSpace="nowrap",h.appendChild(e)}}}observeResize(){const t=this.containers[0];this.resizeObserver=new ResizeObserver(()=>{this.render()}),this.resizeObserver.observe(t)}}class p extends g{supports(t){return t==="fontSize"?!0:super.supports(t)}constructor(){super(),this.settings.size??=5}onOpen(){setTimeout(()=>{this.settings.size??=5,this.game=new d(this),this.game.start([...document.querySelectorAll(".reader .playground")]),this.watch(()=>this.settings.size,t=>this.game?.next(),{immediate:!0}),this.watch([()=>l.fontSize,()=>a.textColor],()=>this.game.render())})}onClose(){this.game?.stop()}next(){this.game?.next()}}export{p as ItemGameShulte,p as default};
