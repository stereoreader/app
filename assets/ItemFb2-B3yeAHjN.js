import{I as c,t as m,C as a,n as k}from"./index-CwcqO7TU.js";class p extends a{async onClick(r){const t=this.item.outline;c.current=null,await k(),c.current=t,Object.assign(t.readingProgressDetails,{chunkIdx:this.chunkIdx,chunkPos:0,screenY:0})}}class x extends c{iconColor="#44ff88";constructor(r=[]){super(c._private.concat("length"))}async parseData(){const r=new DOMParser().parseFromString(this.data,"text/xml"),t=m(this);let h=0,l=0;const s=c.create({title:this.title,isOutline:!0,chunked:!0,mimeType:"text/fb2",id:this.id+"_outline"});t.outline=s,s.outline=t;const g=(e,n)=>{t._chunks.push(new a({text:e,offset:h,idx:t._chunks.length,type:n,item:t})),h+=e.length,n==="title"&&(s._chunks.push(new p({chunkIdx:t._chunks.length-1,text:e,offset:l,idx:s._chunks.length,item:s,type:n})),l+=e.length)};for(const e of f(r.documentElement.children))e.tagName==="body"&&u(e.children,"body");Object.assign(t,{length:h}),Object.assign(s,{length:l});debugger;return t.chunked=!0,this;function u(e,n){for(let o=0;o<e.length;o++){const i=e[o];i.tagName==="p"||!i.children.length?g(i.textContent,n):u(i.children,i.tagName)}}function*f(e){for(let n=0;n<e.length;n++)yield e[n]}}get chunks(){return this._chunks}}export{x as ItemFb2};
